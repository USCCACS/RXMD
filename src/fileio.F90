module fileio

  use mpi_mod
  use utils, only : l2g, get_boxparameters
  use base
  use atoms
  use memory_allocator_mod

contains

!----------------------------------------------------------------------------------------
subroutine OUTPUT(fileNameBase, atype, pos, v, q, f)
!----------------------------------------------------------------------------------------
implicit none

character(len=:),allocatable,intent(in) :: fileNameBase
real(8),allocatable,intent(in) :: atype(:), q(:)
real(8),allocatable,intent(in) :: pos(:,:),v(:,:)
real(8),allocatable,intent(in),optional :: f(:,:)

if(isBinary) then
  call WriteBIN(atype,pos,v,q,fileNameBase)
endif

if(isBondFile) call WriteBND(fileNameBase)
if(isPDB) call WritePDB(fileNameBase)
if(isXYZ) call WriteXYZ(fileNameBase)

return

Contains 

!--------------------------------------------------------------------------
subroutine WriteBND(fileNameBase)
!--------------------------------------------------------------------------
implicit none

character(*),intent(in) :: fileNameBase

integer :: i, ity, j, j1, jty, m
real(8) :: bndordr(MAXNEIGHBS)
integer :: igd,jgd,bndlist(0:MAXNEIGHBS)

integer (kind=MPI_OFFSET_KIND) :: offset
integer (kind=MPI_OFFSET_KIND) :: fileSize
integer :: localDataSize
integer :: fh ! file handler

integer :: BNDLineSize, baseCharPerAtom
integer,parameter :: MaxBNDLineSize=4096
character(MaxBNDLineSize) :: BNDOneLine
real(8),parameter :: BNDcutoff=0.3d0

character(len=:),allocatable :: BNDAllLines

integer :: scanbuf

integer :: ti,tj,tk
call system_clock(ti,tk)

! precompute the total # of neighbors
m=0
do i=1, NATOMS
   do j1 = 1, nbrlist(i,0)
!--- don't count if BO is less than BNDcutoff.
       if(BO(0,i,j1) > BNDcutoff) then 
           m=m+1
       endif
   enddo
enddo

200 format(i12.12,1x,3f12.3,1x,2i3,20(1x,i12.12,f6.3)) 

! get local datasize based on above format and the total # of neighbors
baseCharPerAtom=12+1+3*12+1+2*3 +1 ! last 1 for newline
localDataSize=NATOMS*(baseCharPerAtom)+m*(1+12+6)

if( (baseCharPerAtom+MAXNEIGHBS*(1+12+6)) > MaxBNDLineSize) then
    print'(a,i6,2i12)', 'ERROR: MaxBNDLineSize is too small @ WriteBND', &
                    myid, baseCharPerAtom+MAXNEIGHBS*(1+12+6), MaxBNDLineSize
endif

call MPI_File_Open(MPI_COMM_WORLD,trim(fileNameBase)//".bnd", &
    MPI_MODE_WRONLY+MPI_MODE_CREATE,MPI_INFO_NULL,fh,ierr)

! offset will point the end of local write after the scan
call MPI_Scan(localDataSize,scanbuf,1,MPI_INTEGER,MPI_SUM,MPI_COMM_WORLD,ierr)

! since offset is MPI_OFFSET_KIND and localDataSize is integer, use an integer as buffer
offset=scanbuf

! nprocs-1 rank has the total data size
call MPI_Bcast(scanbuf,1,MPI_INTEGER,nprocs-1,MPI_COMM_WORLD,ierr)
fileSize=scanbuf

call MPI_File_set_size(fh, fileSize, ierr)

! set offset at the beginning of the local write
offset=offset-localDataSize

call MPI_File_Seek(fh,offset,MPI_SEEK_SET,ierr)

allocate(character(len=localDataSize) :: BNDAllLines)
BNDALLLines=""

BNDLineSize=0
do i=1, NATOMS
   ity = nint(atype(i))
!--- get global ID for i-atom
   igd = l2g(atype(i))

!--- count the number bonds to be shown.
   bndlist(0)=0
   do j1 = 1, nbrlist(i,0)
      j = nbrlist(i,j1)
      jty = nint(atype(j))

!--- get global ID for j-atom
      jgd = l2g(atype(j))

!--- if bond order is less than 0.3, ignore the bond.
      if( BO(0,i,j1) < 0.3d0) cycle

      bndlist(0) = bndlist(0) + 1
      bndlist(bndlist(0)) = jgd
      bndordr(bndlist(0)) = BO(0,i,j1)
   enddo

   BNDOneLine=""
   write(BNDOneLine,200) igd, pos(i,1:3),nint(atype(i)),bndlist(0), &
         (bndlist(j1),bndordr(j1),j1=1,bndlist(0))

   ! remove space and add new_line
   BNDOneLine=trim(adjustl(BNDOneLine))//NEW_LINE('A')
   BNDLineSize=BNDLineSize+len(trim(BNDOneLine))

   BNDAllLines=trim(BNDAllLines)//trim(BNDOneLine)
enddo

if(localDataSize>0) then
   call MPI_File_Write(fh,BNDAllLines,localDataSize, &
        MPI_CHARACTER,MPI_STATUS_IGNORE,ierr)
endif

deallocate(BNDAllLines) 

call MPI_BARRIER(MPI_COMM_WORLD, ierr)
call MPI_File_Close(fh,ierr)

call system_clock(tj,tk)
it_timer(20)=it_timer(20)+(tj-ti)

return
end subroutine

!--------------------------------------------------------------------------
subroutine WritePDB(fileNameBase)
!--------------------------------------------------------------------------
implicit none

character(*),intent(in) :: fileNameBase

integer :: i, ity, igd 
real(8) :: tt=0.d0, ss=0.d0

integer (kind=MPI_OFFSET_KIND) :: offset
integer (kind=MPI_OFFSET_KIND) :: fileSize
integer :: localDataSize
integer :: fh ! file handler

integer,parameter :: PDBLineSize=67
character(PDBLineSize) :: PDBOneLine

character(len=:),allocatable :: PDBAllLines

integer :: scanbuf

integer :: ti,tj,tk
call system_clock(ti,tk)

! get local datasize
localDataSize=NATOMS*PDBLineSize

call MPI_File_Open(MPI_COMM_WORLD,trim(fileNameBase)//".pdb", &
     MPI_MODE_WRONLY+MPI_MODE_CREATE,MPI_INFO_NULL,fh,ierr)

! offset will point the end of local write after the scan
call MPI_Scan(localDataSize,scanbuf,1,MPI_INTEGER,MPI_SUM,MPI_COMM_WORLD,ierr)

! since offset is MPI_OFFSET_KIND and localDataSize is integer, use an integer as buffer
offset=scanbuf

! nprocs-1 rank has the total data size
call MPI_Bcast(scanbuf,1,MPI_INTEGER,nprocs-1,MPI_COMM_WORLD,ierr)
fileSize=scanbuf

call MPI_File_set_size(fh, fileSize, ierr)

! set offset at the beginning of the local write
offset=offset-localDataSize

allocate(character(len=localDataSize) :: PDBAllLines)
PDBAllLines=""

call MPI_File_Seek(fh,offset,MPI_SEEK_SET,ierr)

do i=1, NATOMS

  ity = nint(atype(i))
!--- calculate atomic temperature 
  tt = hmas(ity)*sum(v(i,1:3)*v(i,1:3))
  tt = tt*UTEMP*1d-2 !scale down to use two decimals in PDB format 

!--- sum up diagonal atomic stress components 
  ss = sum(astr(1:3))/3.d0*USTRS

  tt = q(i)

  igd = l2g(atype(i))
  write(PDBOneLine,100)'ATOM  ',0, atmname(ity), igd, pos(i,1:3), tt, ss

  PDBOneLine(PDBLineSize:PDBLineSize)=NEW_LINE('A')
  PDBAllLines=trim(PDBAllLines)//trim(PDBOneLine)

enddo

if(localDataSize>0) then
    call MPI_File_Write(fh,PDBAllLines,localDataSize, &
         MPI_CHARACTER,MPI_STATUS_IGNORE,ierr)
endif

deallocate(PDBAllLines)

call MPI_BARRIER(MPI_COMM_WORLD, ierr)
call MPI_File_Close(fh,ierr)

100 format(A6,I5,1x,A2,i12,4x,3f8.3,f6.2,f6.2)

call system_clock(tj,tk)
it_timer(21)=it_timer(21)+(tj-ti)


end subroutine

!--------------------------------------------------------------------------
subroutine WriteXYZ(fileNameBase)
!--------------------------------------------------------------------------
implicit none

character(*),intent(in) :: fileNameBase

integer :: i, ity, idx1, idx0 , igd

integer (kind=MPI_OFFSET_KIND) :: offset
integer (kind=MPI_OFFSET_KIND) :: fileSize
integer :: localDataSize
integer :: fh ! file handler

integer :: OneLineSize, MetaDataSize
character(60) :: a60
character(len=:),allocatable :: OneLine,AllLines

integer :: scanbuf

integer :: ti,tj,tk
call system_clock(ti,tk)

MetaDataSize = 9 + 60 + 2
write(a60,'(3f12.5,3f8.3)')  lata,latb,latc,lalpha,lbeta,lgamma

if(isPQEq) then
  ! name + pos(i,1:3) + q(i) + gid + spos(i,1:3) + newline
  OneLineSize = 3 + 60 + 20 + 9 + 60 + 1 
else if(present(f)) then
  ! name + pos(i,1:3) + q(i) + gid + f(i,1:3) + newline
  OneLineSize = 3 + 60 + 20 + 9 + 60 + 1 
else
  ! name + pos(i,1:3) + q(i) + gid + newline
  OneLineSize = 3 + 36 + 8 + 9 + 1 
endif

! get local datasize
localDataSize=NATOMS*OneLineSize
if(myid==0) localDataSize = localDataSize + MetaDataSize

call MPI_File_Open(MPI_COMM_WORLD,trim(fileNameBase)//".xyz", &
     MPI_MODE_WRONLY+MPI_MODE_CREATE,MPI_INFO_NULL,fh,ierr)

! offset will point the end of local write after the scan
call MPI_Scan(localDataSize,scanbuf,1,MPI_INTEGER,MPI_SUM,MPI_COMM_WORLD,ierr)

! since offset is MPI_OFFSET_KIND and localDataSize is integer, use an integer as buffer
offset=scanbuf

! nprocs-1 rank has the total data size
call MPI_Bcast(scanbuf,1,MPI_INTEGER,nprocs-1,MPI_COMM_WORLD,ierr)
fileSize=scanbuf

call MPI_File_set_size(fh, fileSize, ierr)

! set offset at the beginning of the local write
offset=offset-localDataSize

call MPI_File_Seek(fh,offset,MPI_SEEK_SET,ierr)

allocate(character(OneLineSize) :: OneLine)
allocate(character(localDataSize) :: AllLines)

idx0=1 ! allline index
if(myid==0) then
  write(AllLines(idx0:idx0+8),'(i9)') GNATOMS; idx0=idx0+9
  write(AllLines(idx0:idx0),'(a1)') new_line('A'); idx0=idx0+1
  write(AllLines(idx0:idx0+59),'(a60)') a60; idx0=idx0+60
  write(AllLines(idx0:idx0),'(a1)') new_line('A'); idx0=idx0+1
endif

do i=1, NATOMS
  idx1 = 1 ! oneline index

  ity = nint(atype(i))
  igd = l2g(atype(i))

! element name
  write(OneLine(idx1:idx1+2),'(a3)') atmname(ity); idx1=idx1+3

! atom positions. with high precision for dielectric calculation
  if(isPQEq.or.present(f)) then
     write(OneLine(idx1:idx1+59),'(3es20.12)') pos(i,1),pos(i,2),pos(i,3); idx1=idx1+60
     write(OneLine(idx1:idx1+19),'(es20.12)') q(i); idx1=idx1+20
  else
     write(OneLine(idx1:idx1+35),'(3f12.5)') pos(i,1:3); idx1=idx1+36
     write(OneLine(idx1:idx1+7),'(3f8.3)') q(i); idx1=idx1+8
  endif

! global Id
  write(OneLine(idx1:idx1+8),'(i9)') igd; idx1=idx1+9

! shell charge positions with high precision for dielectric calculation
  if(isPQEq) then
     write(OneLine(idx1:idx1+59),'(3es20.12)') spos(i,1:3); idx1=idx1+60
  else if(present(f)) then
     write(OneLine(idx1:idx1+59),'(3es20.12)') f(i,1),f(i,2),f(i,3); idx1=idx1+60
  endif

  write(OneLine(idx1:idx1),'(a1)') new_line('A'); idx1=idx1+1

  write(AllLines(idx0:idx0+OneLineSize-1),'(a)') OneLine; idx0=idx0+OneLineSize

enddo

if(localDataSize>0) then
    call MPI_File_Write(fh,AllLines,localDataSize, &
         MPI_CHARACTER,MPI_STATUS_IGNORE,ierr)
endif

deallocate(AllLines, OneLine)

call MPI_BARRIER(MPI_COMM_WORLD, ierr)
call MPI_File_Close(fh,ierr)

call system_clock(tj,tk)
it_timer(21)=it_timer(21)+(tj-ti)


end subroutine

end subroutine OUTPUT

!--------------------------------------------------------------------------
subroutine ReadXYZ(atype, rreal, v, q, f, fileName)
!--------------------------------------------------------------------------
implicit none

character(*),intent(in) :: fileName
real(8),allocatable,dimension(:),intent(inout) :: atype,q
real(8),allocatable,dimension(:,:),intent(inout) :: rreal,v,f

real(8) :: dbuf6(6), mat(3,3), mati(3,3)

integer :: ti,tj,tk

integer :: i,j,i1, ntot, iigd, num_unit, funit
real(8),allocatable :: pos0(:)
integer,allocatable :: atype0(:)
character(2) :: c2

call system_clock(ti,tk)

if(myid==0) then
  open(newunit=funit, file=trim(filename), status='old', form='formatted')

  read(funit,fmt=*) num_unit
  allocate(atype0(num_unit), pos0(3*num_unit))

  read(funit,fmt=*) dbuf6(1:6)

  do i = 1, num_unit
     read(funit,fmt=*) c2,pos0(i*3-2:i*3) 

     do j=1, 3
        call assert( pos0((i-1)*3+j)>0.d0, 'ERROR: negative coordinate found in ReaxXYZ(): '//trim(filename))
     enddo

!TODO: use atmname to get the element-to-integer mapping.
!      atmname has to be set based on the input files, e.g. ffield or ffn.in.
     do i1=1, size(atmname)
       if(c2(1:2) == atmname(i1)) exit
     enddo
     atype0(i)=i1
  enddo

  close(funit)
endif

call MPI_Bcast(num_unit,1,MPI_INTEGER,0,MPI_COMM_WORLD,ierr)
if(myid>0) allocate(pos0(3*num_unit), atype0(num_unit))

call MPI_Bcast(dbuf6,size(dbuf6),MPI_DOUBLE_PRECISION,0,MPI_COMM_WORLD,ierr)
lata=dbuf6(1); latb=dbuf6(2); latc=dbuf6(3)
lalpha=dbuf6(4); lbeta=dbuf6(5); lgamma=dbuf6(6)

call MPI_Bcast(atype0,size(atype0),MPI_INTEGER,0,MPI_COMM_WORLD,ierr)
call MPI_Bcast(pos0,size(pos0),MPI_DOUBLE_PRECISION,0,MPI_COMM_WORLD,ierr)

!--- allocate arrays
if(.not.allocated(atype)) call allocator(atype,1,NBUFFER)
if(.not.allocated(q)) call allocator(q,1,NBUFFER)
if(.not.allocated(rreal)) call allocator(rreal,1,NBUFFER,1,3)
if(.not.allocated(v)) call allocator(v,1,NBUFFER,1,3)
if(.not.allocated(f)) call allocator(f,1,NBUFFER,1,3)
if(.not.allocated(qsfp)) call allocator(qsfp,1,NBUFFER)
if(.not.allocated(qsfv)) call allocator(qsfv,1,NBUFFER)
f(:,:)=0.0

iigd = num_unit*myid ! for global ID
do i=1,num_unit
   pos(i,1:3) = pos0(i*3-2:i*3)
   atype(i) = dble(atype0(i)) + (iigd+i)*1d-13
enddo 

!--- assuming XYZ format is in the real coordinates given for one domain. 
!    To run multiple domain job, normalize the coords, update H-matrix, 
!    update the box origin, then scale back to the real coords. 
call get_boxparameters(mat,lata,latb,latc,lalpha,lbeta,lgamma)
call matinv(mat,mati)
call xu2xs_inplace(mati,[0.d0,0.d0,0.d0],num_unit,pos)

NATOMS=num_unit

!--- update to glocal cell parameters
lata=lata*vprocs(1)
latb=latb*vprocs(2)
latc=latc*vprocs(3)

call get_boxparameters(mat,lata,latb,latc,lalpha,lbeta,lgamma)
do i=1, 3
do j=1, 3
   HH(i,j,0)=mat(i,j)
enddo; enddo
call update_box_params(vprocs, vid, hh, lata, latb, latc, maxrc, &
                       cc, lcsize, hhi, mdbox, lbox, obox)

call xs2xu_inplace(hh,obox,num_unit,pos)

call system_clock(tj,tk)
it_timer(22)=it_timer(22)+(tj-ti)

return
end

!--------------------------------------------------------------------------
subroutine ReadH2O(atype, rreal, v, q, f, fileName)
!--------------------------------------------------------------------------
implicit none

character(*),intent(in) :: fileName
real(8),allocatable,dimension(:),intent(inout) :: atype,q
real(8),allocatable,dimension(:,:),intent(inout) :: rreal,v,f

integer :: i,i1

integer (kind=MPI_OFFSET_KIND) :: offset, offsettmp
integer (kind=MPI_OFFSET_KIND) :: fileSize
integer :: localDataSize, metaDataSize, scanbuf
integer :: fh ! file handler

integer :: nmeta
integer,allocatable :: idata(:)
real(8),allocatable :: dbuf(:)
real(8) :: ddata(6), d10(10)

real(8) :: rnorm(NBUFFER,3), mat(3,3)
integer :: j

!=== # of unit cells ===
integer :: mx=1,my=1,mz=1

integer :: ix,iy,iz,ntot, imos2, iigd

integer :: ti,tj,tk

integer,parameter :: nH2O=648
real(8) :: pos0(nH2O*3)
integer :: atype0(nH2O)

call system_clock(ti,tk)

!--- allocate arrays
if(.not.allocated(atype)) call allocator(atype,1,NBUFFER)
if(.not.allocated(q)) call allocator(q,1,NBUFFER)
if(.not.allocated(rreal)) call allocator(rreal,1,NBUFFER,1,3)
if(.not.allocated(v)) call allocator(v,1,NBUFFER,1,3)
if(.not.allocated(f)) call allocator(f,1,NBUFFER,1,3)
if(.not.allocated(qsfp)) call allocator(qsfp,1,NBUFFER)
if(.not.allocated(qsfv)) call allocator(qsfv,1,NBUFFER)
f(:,:)=0.0

pos0=(/ &
13.9282521678000002d0,  1.7212039692000001d0,  1.9105447783000000d0, &
14.8685159468000005d0,  1.4418844089000000d0,  2.0144206911999998d0, &
13.5904870694000000d0,  1.6913495364000000d0,  2.8671520057000000d0, &
 6.9767885410000003d0,  9.5229634388999997d0,  8.5164252208000004d0, &
 7.0922100549999998d0,  9.7800174817999999d0,  9.5057053600000003d0, &
 6.7896383697999996d0,  8.5481061174999997d0,  8.4870861883999993d0, &
 6.6984447730000003d0, -0.4039494729000000d0, 13.7103023523999994d0, &
 7.2320700096000001d0,  0.0908105895000000d0, 13.0826322215000008d0, &
 5.9614778889000002d0, -0.8305812215000000d0, 13.2633525687000002d0, &
 0.5328221147000000d0,  8.3340128538999991d0, 12.9410149830000005d0, &
 0.6471939946000000d0,  7.3634840374000001d0, 12.9971015016999996d0, &
 0.5157600147000000d0,  8.5338535458999996d0, 11.9788103290999999d0, &
18.4614297279999988d0, 16.1326489678999998d0, 12.7214583642000001d0, &
19.3092541108000013d0, 16.5873491490999996d0, 12.3763715605000009d0, &
18.5265747243000014d0, 16.5583299110000013d0, 13.6135982237000004d0, &
 1.6970575390000000d0,  1.0844188606000000d0, 18.4515282240999987d0, &
 2.5672177380000001d0,  1.4156523229000000d0, 18.1145712822999982d0, &
 1.1199344922000001d0,  1.7651438973000000d0, 18.0463700590999991d0, &
14.6572342627999994d0,  9.8175602179000006d0, 18.3430974328999987d0, &
15.3352748917999993d0, 10.0964169621999993d0, 17.6966364479000013d0, &
14.8777515698999991d0,  8.9829827793000003d0, 18.7612720664000001d0, &
 4.9893564405999999d0, 13.3856654175000003d0,  1.5759229878000001d0, &
 5.3605067623000000d0, 14.3386012568000005d0,  1.7291893175999999d0, &
 4.9336587097000004d0, 13.0829850208000007d0,  2.4770517718999998d0, &
10.6703821564000005d0, 12.0310207167000005d0,  0.6649083632000000d0, &
11.5981564282999994d0, 11.9192767443999994d0,  0.7792988900000000d0, &
10.5937322093000006d0, 12.9441898042000005d0,  0.3005518530000000d0, &
 8.5028450565000000d0, 11.2170279638999997d0,  2.3691755396000000d0, &
 9.2390848979999998d0, 11.8008040382000008d0,  2.0746729274000000d0, &
 7.8991865387000004d0, 11.3243434839999999d0,  1.5769834370000000d0, &
17.2682949651000008d0,  2.7261780852999999d0,  8.8974902857000000d0, &
17.0406125867000000d0,  3.3633855462000000d0,  9.5391142649000003d0, &
16.5149439823000002d0,  2.0922032509999999d0,  8.8832970112999998d0, &
 9.6068053089000003d0,  9.4194114226999996d0,  8.1878752338999998d0, &
 8.6095510094000005d0,  9.4851740042999992d0,  8.1374260459999999d0, &
10.0646264217999999d0,  9.4561588684999993d0,  7.2335149578999998d0, &
 9.3435627328000006d0,  1.7497876157000001d0,  8.2551282622999995d0, &
 9.5379943320000002d0,  2.4541703473999998d0,  8.9074389663000009d0, &
 8.8699297946000009d0,  2.0965942229999999d0,  7.4007480023000003d0, &
 5.0495435990999997d0,  2.4511430232000002d0,  1.9555632431000001d0, &
 5.1888900181000004d0,  3.3873555767000001d0,  1.9626375039999999d0, &
 4.7957382191000004d0,  2.1808957390999999d0,  1.0699302193000000d0, &
11.7969914930000002d0, 15.7895072222999993d0, 10.7165190622999997d0, &
12.3955297585000004d0, 16.4236731873000004d0, 10.2507562347000007d0, &
10.9042476603999994d0, 16.2034301762000013d0, 10.8201150851999994d0, &
12.6350104035000008d0,  4.2430097927999997d0,  9.9740241181999991d0, &
13.0103672793000005d0,  4.5354772823999996d0,  9.1210753808000007d0, &
11.7263954483999999d0,  4.5812796628000001d0,  9.9043551974999993d0, &
15.3438455665000006d0, 17.1043631677999990d0,  1.2926290272000001d0, &
15.5080995820999998d0, 16.2214578126000006d0,  1.6970931546000001d0, &
15.2836723930999998d0, 16.9126627800999998d0,  0.2744730446000000d0, &
12.1129647051999996d0,  6.6352742968999996d0, 12.3520862108999996d0, &
12.6786721197999999d0,  7.4295544793000001d0, 12.2695471997999999d0, &
11.2337281275999992d0,  6.8272769510000000d0, 11.9004273390000002d0, &
 1.8390167615999999d0, 15.8721111246000000d0,  7.8406054376999998d0, &
 2.4762699073999999d0, 15.8230460961000006d0,  7.0745848187000000d0, &
 0.9519240584999999d0, 15.6060966869000008d0,  7.5076752940000002d0, &
 3.5721810389000002d0,  1.5581812083000000d0, 13.7693058057000002d0, &
 3.6324825029999999d0,  2.5021894712999999d0, 14.0532156734000004d0, &
 2.6472580644999999d0,  1.5367251528000001d0, 13.4676599391000007d0, &
 2.7771909689999998d0, 14.0420163453000004d0, 18.5291867820000000d0, &
 3.6239179818000000d0, 13.8602556875000005d0, 19.0312338664999992d0, &
 2.9108597799000000d0, 13.5831144580000007d0, 17.6572868272000001d0, &
 8.3675893943999995d0,  0.9344220782000000d0, 11.6162174427000000d0, &
 9.0587471851999997d0,  1.6883634218000001d0, 11.5747424483000003d0, &
 7.5397158893000000d0,  1.2154446598999999d0, 11.1682562511000008d0, &
 9.4289116452999995d0,  3.0969060546999998d0,  3.2645373969000002d0, &
 8.5696058067000003d0,  2.6416326677000002d0,  3.2536550660999999d0, &
10.0469070186000007d0,  2.3547413472000001d0,  3.1391770852000001d0, &
 6.3974478184999999d0, 11.3978463938000001d0, 18.9995568856999988d0, &
 6.6391332728999997d0, 11.9112872935999992d0, 18.2584714607999992d0, &
 5.8600678420000003d0, 11.9748126201999998d0, 19.5559656506000010d0, &
11.9387608901999993d0, 12.6087201391000008d0,  3.5064706686000000d0, &
12.3806057120999995d0, 12.0806326589000008d0,  2.7778831418999999d0, &
12.2412794317000007d0, 12.2254187514999995d0,  4.3469371711999996d0, &
15.8976163545000002d0,  2.3242022002999998d0, 16.7508772410000013d0, &
16.3019050145000008d0,  2.8984827136000000d0, 16.0053961823000002d0, &
15.9960151134000004d0,  1.3851070225000000d0, 16.5368162366000000d0, &
14.3176046609000007d0, 14.7198283631999995d0,  2.5270931521000000d0, &
15.0252142386000003d0, 14.1345312613999994d0,  2.7734634536999998d0, &
13.7718686356000006d0, 14.9174717045000005d0,  3.3371674453000000d0, &
14.7956099242000008d0,  4.3714000393000001d0, 14.7066921815999994d0, &
14.3956027789000007d0,  5.2913021493999999d0, 14.7543098377999993d0, &
14.0249165785999992d0,  3.7446467764000002d0, 14.6969622292000004d0, &
 9.0553612810999997d0, 11.2147261906000004d0,  4.9733381941000001d0, &
 8.7852312860000001d0, 11.2314188954999992d0,  4.0103263159000004d0, &
 8.2656937822999996d0, 11.5237075612000002d0,  5.5828613483999998d0, &
11.7925520390000003d0, 18.5708974731999987d0,  1.3335934695000000d0, &
12.5615483303000008d0, 18.9954829109999999d0,  1.7379822632999999d0, &
12.1277902960000006d0, 17.6299221284999987d0,  1.1230613909000000d0, &
10.2150209426000007d0,  7.5501042636999998d0, 10.5230190621999995d0, &
 9.7022576711999999d0,  8.0210966144999993d0,  9.8235016796999997d0, &
10.0799838222000009d0,  6.6623839059999996d0, 10.1526737271999998d0, &
 4.5238261397999997d0, 12.8904134498000005d0,  6.8593283615000002d0, &
 4.6638205385999996d0, 13.8337340151999992d0,  7.0601056873000001d0, &
 3.5959133214999999d0, 12.7570232235999992d0,  6.9102364497000002d0, &
 6.5030908981000000d0,  6.1896928226999997d0,  7.1205665823000004d0, &
 6.0431032019000002d0,  6.4337924913000002d0,  6.3373803730000002d0, &
 5.8793886410000002d0,  5.5321828035999996d0,  7.4335244044000000d0, &
 8.7891586960999994d0, 12.4194045033999991d0, 11.2181840716999996d0, &
 9.2025278369999999d0, 12.3718925751000004d0, 12.0653062122999994d0, &
 8.1333725828999999d0, 11.6969005278000004d0, 11.2019597770000008d0, &
14.0713876369000008d0,  6.9210385988000001d0, 14.9580419513000002d0, &
13.9246495866999993d0,  7.1289224446999997d0, 14.0071876654000000d0, &
13.3671412141000001d0,  7.4393689022000000d0, 15.3807304399000007d0, &
11.2901096403000007d0, 14.2331094035000003d0, 15.6843172624000005d0, &
11.2534716518000000d0, 14.0646594623999999d0, 16.6148872640000000d0, &
11.1287652869000002d0, 15.1842111337999999d0, 15.6022052653000003d0, &
 7.2802230183000001d0, 13.3921556575000000d0,  9.1442391193999999d0, &
 7.9039140872999996d0, 13.0946315016000003d0,  9.7931687673999992d0, &
 7.4667878633999996d0, 13.1330554902000003d0,  8.2860933043999996d0, &
15.8180809860000000d0, 13.6977690249999995d0,  4.8165302585000003d0, &
15.9013121700000006d0, 12.7525489000000007d0,  4.6412464150000003d0, &
14.9748058874000005d0, 13.7013725383999994d0,  5.3502422032999997d0, &
11.4641018129999992d0,  1.6468431155000001d0,  6.5882033678000003d0, &
11.4252396222999995d0,  2.6044257623000000d0,  6.7077644936000000d0, &
10.6335677682000007d0,  1.4741748726999999d0,  7.0572737826000003d0, &
 5.9144929220000000d0,  8.5230989462999993d0,  5.3758900818999997d0, &
 6.8994637625999999d0,  8.5674343751999995d0,  5.5350501373999998d0, &
 5.8297024842000003d0,  7.6855717545999997d0,  4.8860886031000001d0, &
 9.7409182889999997d0, 18.0868411044000013d0,  3.0434921960999999d0, &
 9.1948626557999997d0, 18.1117093561000004d0,  2.1695308265000000d0, &
10.6548159108000000d0, 18.1885718778999994d0,  2.6327002432000000d0, &
 1.1898907617000001d0,  3.1505423708000002d0,  7.9511595513000000d0, &
 1.4244775276999999d0,  2.8412928577000001d0,  7.0266880183999998d0, &
 0.3566866672000000d0,  2.7847916319000001d0,  8.3237456843000004d0, &
 7.8000752816999999d0,  8.8125579450000000d0, 19.1203787283999986d0, &
 7.6022984286000002d0,  8.3131221724000000d0, 18.2709898706000011d0, &
 7.1573791057999996d0,  9.5499533348999996d0, 19.0862386786000009d0, &
 8.0566709838000001d0,  8.0061173732000004d0, 12.2744015473000001d0, &
 8.9715675201000007d0,  7.9358146443999997d0, 11.9521734188999993d0, &
 7.5259261337999996d0,  7.5993798157999999d0, 11.5654465956999992d0, &
17.1340536943999986d0,  9.5495542911999998d0, 14.2926463446999996d0, &
17.7509080638999990d0,  8.8896408731999994d0, 13.9549655302000009d0, &
17.1546010863999996d0, 10.3110194726000000d0, 13.6124268254000000d0, &
10.4692173481000008d0, 13.5146253266999992d0,  6.2562100444000004d0, &
10.9731375135999993d0, 12.9109983221999993d0,  6.8725413684000003d0, &
10.1329962130000002d0, 12.9586892606999999d0,  5.5206183691000001d0, &
 8.0770345173999996d0, 14.8249355308999995d0,  6.5862460027000003d0, &
 8.9266074200999999d0, 14.2978117224000005d0,  6.5038436733999996d0, &
 7.9631871747999998d0, 15.4643554465000008d0,  5.8544038462000003d0, &
12.8543128650000007d0, 17.6366135686000014d0,  8.8775479855999997d0, &
12.8104434222000005d0, 16.8278374725000006d0,  8.3542395193000001d0, &
11.9360764824000007d0, 17.9849218107000013d0,  8.7717068758999996d0, &
 0.4458499896000000d0,  5.4118267605000003d0, 11.9994099324000008d0, &
 0.1782910291000000d0,  5.7387125115000002d0, 11.0808386516000006d0, &
-0.4299993787000000d0,  5.3729841489999997d0, 12.4642437714999996d0, &
10.1296455514999995d0, 12.3645117591999991d0, 13.6645160081999997d0, &
10.9260971654999999d0, 11.8540662973999993d0, 13.9356587165000008d0, &
10.1436922613000000d0, 13.1644376634999993d0, 14.2286639826000005d0, &
18.0675070660999992d0,  4.3275505486999997d0,  2.6385697279999998d0, &
18.1079792302000016d0,  5.2420254784999996d0,  2.2689257027999998d0, &
17.4959020099999982d0,  3.8107990783000001d0,  1.9760011778000000d0, &
10.2626568726999992d0,  8.9254408699999992d0,  2.7826910586000002d0, &
 9.8377173304000003d0,  9.8079432657000005d0,  2.7574679564000002d0, &
10.2740986105999994d0,  8.8715955221999998d0,  1.7546436414000000d0, &
 0.7036553161000000d0,  8.7137905367999995d0,  7.1665164597000004d0, &
 0.9278264832000001d0,  7.9199237562000002d0,  6.5802426333000001d0, &
 0.8067827424000000d0,  9.4873269754000003d0,  6.5679890093999997d0, &
 7.2714811651000000d0,  1.3805698586999999d0,  3.5491325381999999d0, &
 7.6678171087999996d0,  0.6567167800000000d0,  3.1684309013999998d0, &
 6.4840050500000004d0,  1.5961934734000001d0,  2.9924586142999998d0, &
16.0545352391000016d0, 18.3104021448999994d0, 15.5889105850000007d0, &
17.0103275969999999d0, 17.9941055954000007d0, 15.6610375401000006d0, &
15.9634669495000008d0, 17.9199852867000011d0, 14.6351787094999999d0, &
 1.6608368681000001d0, 15.1761672340999993d0,  2.6666437546999999d0, &
 2.2544072265000001d0, 14.9078707887000004d0,  1.9234767763000000d0, &
 0.7995675109000000d0, 14.7751462567999994d0,  2.3305831694000001d0, &
 4.5885049636000002d0,  4.4247876056999997d0,  7.4109433814000001d0, &
 4.3374322868000004d0,  4.4817255420000004d0,  6.4960906652999997d0, &
 3.7828367465000001d0,  4.7686636662000002d0,  7.8776008872999999d0, &
 5.8513327016999996d0, 17.7704561685999991d0,  9.5782666013999993d0, &
 6.1983515107000002d0, 16.8303464128999991d0,  9.4526280780000000d0, &
 4.8773068455999997d0, 17.6548461343999996d0,  9.3447945469999993d0, &
 8.2428289535000001d0, 16.2407413178000013d0,  4.1911764455000000d0, &
 8.8738516105999992d0, 16.8429420209999989d0,  3.8384445992999998d0, &
 8.6711098338999992d0, 15.4283428750000002d0,  3.8571276743000000d0, &
 1.8757533922000000d0,  9.7160569365999994d0,  3.5513242948000001d0, &
 2.8341749631000002d0,  9.8695099219000006d0,  3.5613345101000000d0, &
 1.6031495129000000d0,  8.7598403617000002d0,  3.5107478945000001d0, &
16.3014925451000003d0,  1.6319535658000000d0,  5.1965630310000002d0, &
16.6014868558000011d0,  1.4590966164000001d0,  4.3092167301000002d0, &
15.8231784891000000d0,  0.8633958496000000d0,  5.5887343759999997d0, &
 1.1051801325999999d0,  7.4887671509000002d0,  0.2585353527000000d0, &
 1.9516539205000001d0,  7.1002030487000001d0,  0.6068036904000000d0, &
 1.2370340407000000d0,  8.3875415774000004d0, -0.0958745281000000d0, &
 8.3609863407000002d0,  2.4708018904000002d0,  5.8207862825000003d0, &
 8.9598011396999997d0,  3.0540071830000000d0,  5.3909545394000000d0, &
 7.8981275811999998d0,  1.9774882680999999d0,  5.1110518904999998d0, &
 9.8954466409999995d0,  3.3369914185999998d0,  0.4849827468000000d0, &
 9.6070190023999995d0,  3.5091802497000000d0,  1.4227901697000001d0, &
 9.2257551615000004d0,  2.7365524745999998d0,  0.1139209979000000d0, &
17.4481849657999994d0,  6.1775745753000004d0, 18.4694956310000009d0, &
18.2727251511000013d0,  6.6274912672999999d0, 18.7519502946999985d0, &
17.2089152172999995d0,  6.6184493854999999d0, 17.6082398861000016d0, &
 8.1215351578000003d0, 14.5470517819000005d0, 19.3354239161000017d0, &
 7.7428017013000003d0, 14.7456901217999992d0, 18.4462660689000018d0, &
 7.4299386055000003d0, 14.8576623322000003d0, 19.9475792669000001d0, &
16.4664182220999997d0,  7.4874805147999997d0, 16.1116492019999988d0, &
16.8090699271000013d0,  8.2958040504999992d0, 15.6731099160999996d0, &
15.5990071355000008d0,  7.3670571563999996d0, 15.6912695725999995d0, &
17.8711499879999991d0, 10.4624013467000001d0, 18.9354197542999998d0, &
18.8208289596999983d0, 10.2082670354000005d0, 18.8797585714000000d0, &
17.6071481100999989d0, 10.6577954989000006d0, 18.0309080496000007d0, &
 1.6258743035000001d0, 12.7658594301000008d0, 13.8545901999000005d0, &
 1.5482858579000001d0, 11.8457829715000003d0, 14.2578234453999997d0, &
 0.7600058749000000d0, 13.0188337177999998d0, 13.4272345787000003d0, &
 3.0039318653999998d0, 17.7284327688999994d0,  9.3891269923999996d0, &
 2.9787333771000002d0, 18.4972890218999986d0,  8.7624774063000004d0, &
 2.4706782614999998d0, 17.0513918002000011d0,  8.8426450910999996d0, &
12.6563941090000007d0, 13.9574696223999997d0,  8.8940799542000004d0, &
12.1437664005000006d0, 14.5254513993999996d0,  9.5337146819999994d0, &
12.1224492644000001d0, 13.1430463127999992d0,  8.9817487274999994d0, &
 2.1883707219000001d0, 16.7854459829999989d0, 11.6700635364000007d0, &
 2.5337072076000000d0, 15.9204431436000000d0, 11.3643099442000004d0, &
 2.3063052786000000d0, 17.3574390811000008d0, 10.9050468664999993d0, &
 1.0522969648000000d0, 11.0158982117999997d0,  5.7841814854000004d0, &
 1.4331660507999999d0, 10.5924103305999999d0,  5.0264995735999998d0, &
 1.0054744123999999d0, 11.9200173992000007d0,  5.4804803575000003d0, &
15.2526888905000000d0, 12.4611826963999999d0,  9.2061315368999992d0, &
14.9963891146999995d0, 11.7261989101000008d0,  8.3948608585999995d0, &
14.4790180078000006d0, 13.0813500606000002d0,  9.2395564781000008d0, &
10.1742258141999997d0,  2.6343540368000000d0, 10.9239173427999994d0, &
11.0336763527000006d0,  2.4163564853000001d0, 10.5097542168999993d0, &
10.1418947000999999d0,  3.6238749074999999d0, 10.9947354720000003d0, &
 7.1140379297000003d0,  5.1347772738000002d0, 15.6846014410999999d0, &
 7.6158733718000002d0,  4.9779037010999998d0, 14.7924953324999997d0, &
 7.3564866017000003d0,  6.0571588620999997d0, 15.8726298814000000d0, &
 4.4715359434000002d0, 10.0789875182999999d0,  3.7839559334000001d0, &
 5.1598963263000002d0,  9.5543776849000004d0,  4.3658607912000003d0, &
 4.4979104916999999d0, 11.0742538717999999d0,  3.9852070769000001d0, &
13.3361295546999994d0, 11.8022844155000008d0,  1.0046284026000001d0, &
14.0926173190000004d0, 12.4001871947000009d0,  0.9082927366000000d0, &
13.7714595227000007d0, 10.9883162767000009d0,  0.6473584603000000d0, &
 7.0354015283000004d0, 11.6050345238000006d0,  6.7166450797000001d0, &
 6.9013150267999999d0, 10.8203574948999997d0,  7.2873845467000002d0, &
 6.0934589688000003d0, 11.8299789778999997d0,  6.5126727941000002d0, &
 9.3286858631000005d0, 16.8064580558000003d0, 10.9598430197999992d0, &
 9.0774630786999992d0, 17.5885810189000011d0, 11.5229357659999998d0, &
 8.4339264870000008d0, 16.4910645757000012d0, 10.6330833217999992d0, &
 8.2295575818000000d0,  5.7098267851999998d0,  0.8183533303000000d0, &
 8.8985576342999995d0,  6.2561358296999998d0,  1.2036997235000000d0, &
 8.7706965868999998d0,  5.0479202000000001d0,  0.2781731489000000d0, &
 2.7864942803999999d0,  5.5083929020999998d0, 16.9466508576000017d0, &
 3.6339932747999999d0,  4.9607774557999997d0, 16.7361842297000010d0, &
 2.1194814280999998d0,  5.0600142064000000d0, 16.4348272034999994d0, &
16.4242456471999994d0,  5.4929538283000001d0, 12.6286087362000004d0, &
16.0402463060999985d0,  5.5351400154999997d0, 13.5177913838000006d0, &
15.8248470136999995d0,  4.8929747168000004d0, 12.1408800468999996d0, &
10.9915850783000000d0, 16.9000061967000015d0, 15.9921876507000000d0, &
11.5218076285999995d0, 17.2128571719999997d0, 15.1878994905999996d0, &
11.0382403679000003d0, 17.7160264269000010d0, 16.5654875236000017d0, &
11.9955908608000001d0,  6.9850282332000004d0,  4.2459586136000000d0, &
11.7057164092000008d0,  6.1754643057000003d0,  3.8295947804999999d0, &
11.2600090684000005d0,  7.6107751228999998d0,  4.0777520144999997d0, &
15.3182485938999999d0,  0.5744460978000000d0,  8.7450934607999997d0, &
15.5415338468000002d0,  0.2284631241000000d0,  7.8510566521999996d0, &
14.3914059211000005d0,  0.5479725345000001d0,  8.7433486703999996d0, &
 3.0747121414000000d0, 14.2810091873000005d0, 15.6624300905999991d0, &
 3.7912285972999999d0, 13.6857497926999994d0, 15.3444042276000001d0, &
 2.3248921355999999d0, 13.8165372846000007d0, 15.2352120835000004d0, &
18.2463112579000004d0, 14.9190703032999998d0,  6.6358786428999998d0, &
18.1188307936999990d0, 14.4617920015999992d0,  7.5249715989999997d0, &
17.3603893935999984d0, 14.7425835482000007d0,  6.2888855667000003d0, &
 1.4294482317999999d0, 13.5716186442000009d0,  4.9811083573000001d0, &
 1.3665951260000000d0, 14.0256089379999995d0,  4.1126390592000002d0, &
 0.8579731446000000d0, 14.0546307867000007d0,  5.6624157366999999d0, &
 1.6959461837000001d0, 12.1606407262000005d0,  8.2962873782000006d0, &
 1.5923033571000000d0, 11.6890880361999994d0,  7.4196156815999998d0, &
 0.8324994281000000d0, 12.3352922533000005d0,  8.7708543395999996d0, &
11.0018369574000001d0,  0.8013346776000000d0, 17.2884863877999990d0, &
11.6061755275999996d0,  1.4869685106999999d0, 16.9684270804000015d0, &
11.4237467514999995d0,  0.6121380091000000d0, 18.1831657685999986d0, &
 7.2802159325000000d0,  0.2029690824000000d0,  1.1988121844999999d0, &
 7.2844148414000003d0,  1.1394585424000001d0,  0.8513106073000000d0, &
 6.5804138117999997d0, -0.2332945359000000d0,  0.7159236710000000d0, &
19.3668139211000003d0,  8.5219814375999992d0, 10.0975889198999997d0, &
19.5910725421999992d0,  8.5474156227999991d0,  9.1296770092999999d0, &
18.4474820332000000d0,  8.0482664530000001d0,  9.9984487602000005d0, &
 4.0732976431000001d0,  0.8900857170000001d0,  7.3730525076999998d0, &
 4.6302324371000001d0,  0.3685919670000000d0,  6.7639274647000001d0, &
 3.4691569163999998d0,  1.3281301141999999d0,  6.7046004875999996d0, &
 5.2504503344000000d0, 17.6416088866000003d0, 18.6546425657999997d0, &
 5.5131514045000003d0, 17.6536972988999992d0, 17.7524326344000016d0, &
 4.2556934141999996d0, 17.7427802531000012d0, 18.6563172438999985d0, &
 2.3189637265999998d0,  9.9906362684999994d0, 14.2783326112999998d0, &
 3.2791364279000002d0,  9.7215387523000008d0, 14.1891769342000007d0, &
 1.7734152891999999d0,  9.3139531338000001d0, 13.8004455693000008d0, &
 4.3587281654999996d0, 12.7568248206000003d0,  4.2351100336999998d0, &
 4.7507715926999996d0, 12.7266373541999993d0,  5.1219851274000003d0, &
 3.3921482029000001d0, 12.8737917896000003d0,  4.4688845407000004d0, &
 4.6874504497000000d0,  2.8914052827000001d0,  4.9917783000000000d0, &
 5.3680164282999998d0,  2.9293356878000001d0,  5.6814769708000004d0, &
 5.1330832029000000d0,  2.3954659903000000d0,  4.3123305758999999d0, &
16.8639084088000004d0, 11.2833715829999992d0, 16.3313061411000007d0, &
17.1053001746000000d0, 10.6076743100000002d0, 15.6015813399999992d0, &
16.4758818968000007d0, 12.0675542825999997d0, 15.9377429915000004d0, &
11.1257650006999995d0,  4.2923440825999997d0,  6.4545895653000001d0, &
11.9344156030999997d0,  4.6590808696000003d0,  6.0332630463000001d0, &
10.4403219253999993d0,  5.0729063000999997d0,  6.6049607774999997d0, &
14.6703812596999992d0, 10.5025374937000002d0,  7.6102401433000004d0, &
15.4650174113999999d0,  9.8806229149000000d0,  7.4902270166999996d0, &
14.0891066670999994d0,  9.9861283804000003d0,  8.1814681590999996d0, &
15.9013123565000001d0, 17.3252023203999990d0, 13.0313875568000004d0, &
16.7673482342000000d0, 16.8336042128000010d0, 12.7604947170000003d0, &
15.2502088528000002d0, 16.5629625468000015d0, 13.0420548887999992d0, &
10.8425637152000007d0, 14.5460493246000002d0, -0.2136513320000000d0, &
 9.9555498885000002d0, 14.8922916765999993d0,  0.0195137944000000d0, &
11.5667910371999998d0, 15.0955878256999991d0,  0.2221733382000000d0, &
14.5919410237000005d0, 18.1950080418999995d0,  5.9561105652000004d0, &
14.5267945356000006d0, 17.7657631167999988d0,  5.0725650618999998d0, &
13.6769236554999996d0, 18.2119847391000000d0,  6.1729775551000001d0, &
17.7651723829999995d0, 13.8580092955000005d0,  2.7583052021999999d0, &
18.0781484789999993d0, 12.9209831777000002d0,  3.0381625392000000d0, &
17.3226452709999990d0, 14.2752942853999993d0,  3.5795047954000001d0, &
 1.0172894612000001d0,  3.6644453406999999d0, 15.1270624875999999d0, &
 1.5058264937000001d0,  3.8753805653000000d0, 14.2560801467000005d0, &
 0.8725363735000000d0,  2.7331645192999998d0, 15.0165531264999998d0, &
11.2049319064000006d0, 16.4195662075999991d0,  6.5396427379000004d0, &
10.9651469440000007d0, 15.5178284157000004d0,  6.7539508137000004d0, &
10.6798788361000003d0, 17.0802756617999982d0,  7.1174091026999999d0, &
 2.9611838472000001d0, 14.2547726260999994d0, 11.3225429393999999d0, &
 3.4957434799999998d0, 13.7467238504000004d0, 10.5870245464000003d0, &
 3.4746681941999999d0, 14.0560089789999996d0, 12.0860423109999999d0, &
 2.9309583411000002d0, 16.8903950250000001d0, 16.4744919568000014d0, &
 3.1131503016000002d0, 15.9966509726999995d0, 16.0915008535999995d0, &
 2.5764194238000000d0, 16.7000338576000011d0, 17.3868920461000016d0, &
 4.7307946094000002d0,  5.6046351470999998d0, 10.3251029167000006d0, &
 4.3665727297999997d0,  4.7301324578999999d0, 10.2106433963000001d0, &
 4.2607584717000000d0,  6.2068677363999996d0,  9.6941054330000007d0, &
 1.4297219683000000d0,  6.9499101535000003d0,  3.8472532084000002d0, &
 2.1483703244000001d0,  6.2770548545000002d0,  4.0753907576000001d0, &
 0.6335884705000000d0,  6.4912320290999999d0,  4.2390717540000002d0, &
19.1394828502999985d0,  1.9866263679000000d0,  3.5944413352000000d0, &
19.1916779475000006d0,  2.8144301336000002d0,  3.0462273234000001d0, &
18.2590075590999987d0,  1.6204894516999999d0,  3.5586741569000000d0, &
12.7377965915000004d0,  3.5793216827999998d0, -0.0974013363000000d0, &
13.2618373215999998d0,  3.0629052971999999d0,  0.4518917716000000d0, &
11.7445601396000008d0,  3.4063189145999999d0,  0.2000003095000000d0, &
14.7815645197999999d0, 16.2937801871999994d0, 17.4171729335000016d0, &
15.5458681322000007d0, 15.9018279433000007d0, 16.8724979168999987d0, &
14.3923792893000009d0, 16.8940930782000009d0, 16.7819813889999985d0, &
 4.6363379914999996d0, 10.8380923750000004d0, 11.5803902214000001d0, &
 4.4225533341999999d0, 11.4074564466999995d0, 10.8146535946999993d0, &
 4.3543263781999997d0,  9.9382395982999991d0, 11.2586754421999995d0, &
 0.1973714695000000d0, 17.4141655614999991d0, 15.0924823709000009d0, &
 0.9777002278000000d0, 17.1838034370999999d0, 15.6190102245000002d0, &
 0.3872964859000000d0, 18.3367207524999998d0, 14.8053712035000000d0, &
19.1421432035999999d0,  1.4323806432999999d0, 13.7798675963000008d0, &
19.4872853886000001d0,  1.9554177972000000d0, 13.0396761037999998d0, &
18.2012786214000002d0,  1.6922223977999999d0, 13.7995622656000005d0, &
16.0480373538000016d0, 12.3585831638000005d0,  1.2421056246000000d0, &
16.6700904791000006d0, 13.0256758248000004d0,  1.6882332664999999d0, &
16.5780327848999995d0, 11.6006262101999997d0,  0.8987037548000000d0, &
 3.0493476956999999d0, 11.5737979828000004d0, 16.2588530517999992d0, &
 3.8655942992000001d0, 11.0185596837999995d0, 16.1306434938000010d0, &
 2.4879846358000002d0, 10.9735807504000000d0, 15.6814167370999993d0, &
 4.7585585382000000d0,  6.6815842459999999d0, 12.6498126856000006d0, &
 4.7989825932999999d0,  5.9844676519000002d0, 11.9012539560999997d0, &
 4.1570097305999996d0,  7.2609204932999996d0, 12.0885773571000001d0, &
 5.2449696375999997d0, 10.1091162469999993d0, 15.5837330868000006d0, &
 6.2232520215999996d0, 10.1062110599999997d0, 15.5233391341000004d0, &
 5.0021959501000000d0,  9.1803268378999991d0, 15.5474986171000005d0, &
10.4522001871000008d0,  9.4832729528000002d0,  0.2493403798000000d0, &
 9.5165338012999996d0,  9.2164518502000004d0,  0.1354659991000000d0, &
10.4464438890999993d0, 10.4611542419999992d0,  0.3688614147000000d0, &
 7.0728387229000003d0, 10.3610947901999992d0, 11.0810525314999992d0, &
 7.3588262281999999d0,  9.6047476234999998d0, 11.6559584618999992d0, &
 6.1659748983000000d0, 10.5710318462000004d0, 11.3255467685000006d0, &
 2.2779966738000001d0,  1.9370177822000001d0,  5.6862034006000002d0, &
 3.0994028746000000d0,  2.4063285555000000d0,  5.4387096233000003d0, &
 1.7110481216000000d0,  1.6560472253000000d0,  4.9280629615000002d0, &
13.7251107880000003d0, 15.4440437513000006d0, 12.6459779506000007d0, &
13.5893501678999993d0, 14.6147500982000000d0, 13.0793069198000005d0, &
13.0284834884999992d0, 15.4840057362000003d0, 12.0110832647999999d0, &
13.7770483714999994d0, 17.6842804525999995d0,  3.4929542766999999d0, &
14.1147263888999994d0, 17.5298302309999983d0,  2.6217243049999999d0, &
13.2252588166000002d0, 16.9009724790000000d0,  3.7001528489000002d0, &
 4.5356676672000003d0, -0.3987641430000000d0,  2.9957848483000000d0, &
 4.7416271529999996d0,  0.3870977100000000d0,  2.4576985272999998d0, &
 3.5748829746999999d0, -0.5701701771000000d0,  2.9753094333000001d0, &
 6.3640998890000002d0, 15.3715919672000005d0, 10.7902856393000004d0, &
 6.5680166067999997d0, 14.7959737252999997d0, 11.5410976602000002d0, &
 6.3525179264000000d0, 14.6993380306999999d0, 10.0546840811999996d0, &
12.7137704338000006d0, -0.8525953787000000d0, 14.0604456359000007d0, &
13.0331823209000000d0, -1.5178252144000000d0, 13.3729129889999996d0, &
12.6134094615999999d0,  0.0240203772000000d0, 13.6828988681000006d0, &
 4.2182657294999997d0,  4.2151129116000003d0, 14.6058443388000008d0, &
 5.1296801435999999d0,  3.7868131978999999d0, 14.6168590625999997d0, &
 4.2097608784000000d0,  4.8734463778999997d0, 13.8992349807999993d0, &
13.8655152320999999d0,  5.3435032136000000d0,  7.8373153785999996d0, &
14.1936635647999996d0,  4.9568657090999997d0,  7.0369484751000000d0, &
13.4684261402000001d0,  6.2751530571999998d0,  7.6695803596000003d0, &
15.2682267929000002d0,  3.6109645397999999d0, 10.9549327315999996d0, &
15.1235546327999995d0,  2.6327006162000002d0, 11.0989966299000002d0, &
14.4207826203000007d0,  3.8903180375000002d0, 10.5979268294000004d0, &
 6.9665040298000003d0,  7.0260135600000000d0,  9.7862136601999996d0, &
 7.2038179050000002d0,  6.2104939990999997d0,  9.3050863463999995d0, &
 6.0917979029999998d0,  6.6267634788000001d0,  9.9971121503999996d0, &
13.3268985932999993d0, 13.2521564104999996d0, 14.2963087823000006d0, &
13.1169037319000008d0, 12.3078695628000006d0, 14.2284349985999992d0, &
12.6190398930000001d0, 13.5849521099999997d0, 14.8840669020000007d0, &
10.0659932395999991d0, 17.9136263209000006d0,  8.4519019122000003d0, &
 9.6948994180000003d0, 17.4507000597000008d0,  9.2556276818000001d0, &
 9.6274399683999992d0, 18.7695809386000008d0,  8.4164759721000006d0, &
 5.2691535480000002d0,  4.6203754991999997d0, 17.6508023676999990d0, &
 5.7880065240000000d0,  4.6372242786999998d0, 16.7767749881000015d0, &
 5.1656369608999997d0,  5.5742722132999996d0, 17.9476170089999982d0, &
 3.1815447067000000d0,  3.5016551066999999d0,  9.8595866011000002d0, &
 3.6417198043000001d0,  2.6398235455000001d0, 10.1582083134999994d0, &
 2.3735931766000000d0,  3.3893778330000002d0,  9.2383722134999999d0, &
16.6984240706999998d0,  2.5737596300000001d0, 13.8712485945000008d0, &
16.2738611957000003d0,  2.0831938148000000d0, 13.1926994646000004d0, &
16.1110851333000014d0,  3.3417972841000001d0, 13.9993990418000003d0, &
 4.1542796380000002d0,  1.8812417343000001d0, 17.6667534854000010d0, &
 4.6099666132000001d0,  1.3794892709000000d0, 17.0202986538999994d0, &
 4.3006479202000003d0,  2.8350541643999998d0, 17.4608922687999986d0, &
16.7322997075000011d0,  3.4621885698999999d0,  0.4234735231000000d0, &
16.5435602609000014d0,  4.3762499115000004d0,  0.1505220656000000d0, &
16.4013446434000016d0,  2.9392685185000000d0, -0.3620970653000000d0, &
 5.4808283085999996d0,  6.0672570908000001d0,  4.4574728243999999d0, &
 6.0459298853999996d0,  5.4595490258000003d0,  3.8932875562999998d0, &
 4.6989154961999997d0,  6.0613521769999998d0,  3.9237573368000001d0, &
13.2772749036000004d0, 10.5756592609000002d0,  5.3626366112000001d0, &
13.9473469662999996d0, 10.6434994800999991d0,  4.6257486034999999d0, &
13.7518998568999997d0, 10.6905377770999994d0,  6.2497153290999998d0, &
 0.1773568194000000d0, 14.9634780821000000d0, 18.2701656776000014d0, &
 0.8926619727000000d0, 14.2768237040999999d0, 18.3158379027000002d0, &
 0.5725112954000000d0, 15.7608256795999999d0, 18.7499763337999994d0, &
 5.1982350985999997d0,  6.9132428893000002d0,  0.3556952116000000d0, &
 5.8647355340000002d0,  7.5150059497999999d0, -0.0647666507000000d0, &
 4.6573334686000001d0,  7.6727894910999996d0,  0.7840674618000000d0, &
12.2696805251000001d0, 15.4740723460999998d0,  4.2181301664999999d0, &
11.7174587350999992d0, 15.8446794836000002d0,  4.9741998673000003d0, &
11.5735415879999994d0, 15.2528820724000003d0,  3.5176802524999999d0, &
13.4779793199999993d0,  8.9058237717999997d0, 12.1086805799999997d0, &
14.3823573263999993d0,  9.2962710243999993d0, 12.1996828595999993d0, &
13.4074339949999999d0,  8.8112890235000005d0, 11.1430928189999996d0, &
17.4095084982000010d0, 11.8011294265999993d0, 12.8957076777000008d0, &
18.0199981214000005d0, 12.3927491328000006d0, 12.3274033093999993d0, &
16.9539278103000015d0, 12.3696072110999999d0, 13.5863226572000002d0, &
 9.8509987713000005d0,  5.1963407600000000d0,  9.3758483483999999d0, &
 9.8388835075000003d0,  5.4777441113999998d0,  8.4471544113999997d0, &
 8.9478637672999994d0,  4.8497029071000002d0,  9.4846302606999995d0, &
10.8951293262999993d0, 11.6403692804999999d0,  9.4668493226999999d0, &
10.4841824176999996d0, 10.8679477402000000d0,  8.9807921415000003d0, &
10.1146685478999991d0, 11.7845683688000005d0, 10.0560977027000007d0, &
 2.5358913190000001d0,  4.5329084854000001d0,  1.1764873699000000d0, &
 2.9404143705000001d0,  5.0177207996000002d0,  0.4092479896000000d0, &
 1.9028816481999999d0,  4.0279284301000002d0,  0.6458089029000000d0, &
18.7922119352999992d0,  4.8066800336000002d0,  5.2620725742000003d0, &
18.5039062473000016d0,  4.6685266431999999d0,  4.3342837577999997d0, &
18.0502057264000015d0,  4.3722024154000003d0,  5.8242245843999996d0, &
 0.3972701533000000d0,  3.2593923443000001d0, 17.7988063558999983d0, &
 0.4360957962000000d0,  3.6971991800000001d0, 16.9671229162000010d0, &
-0.3518947869000000d0,  3.5611342424000001d0, 18.3905416728999995d0, &
 6.2606412937000000d0, 15.1819423654999994d0, 16.0448356811000004d0, &
 6.9260823988000002d0, 15.8904509102000002d0, 15.9023929444000007d0, &
 5.5054632875999996d0, 15.5492516122000008d0, 15.5082817622999993d0, &
 4.4776517537000000d0,  9.6129770599000004d0,  1.0764926228000000d0, &
 5.0968360533999997d0, 10.3017280951999997d0,  0.7148553901000000d0, &
 4.4497699764999998d0,  9.7388878279999993d0,  2.0581821684000001d0, &
 4.0778193297999996d0, 12.4668008208999996d0,  9.6039773200000003d0, &
 4.6111182457000002d0, 12.4650767284999997d0,  8.7546747973999999d0, &
 3.1759036465000001d0, 12.2252621175999998d0,  9.2300583066000002d0, &
15.9693297212999994d0, 10.3147339350999996d0, 11.1403349424999991d0, &
16.5333335551000005d0, 10.8569785147999998d0, 11.6407852929000004d0, &
15.5639498446999998d0, 10.8866006072000001d0, 10.4968108442000005d0, &
 7.2751643008000002d0,  2.4512569556999999d0, 18.3975092736000008d0, &
 7.3991988179000003d0,  2.3133071895000001d0, 17.4588060536000000d0, &
 7.0603287041999998d0,  3.3686928267999998d0, 18.3909947926000008d0, &
 4.3888995954999999d0,  1.4491785167000000d0, 11.2100478699000004d0, &
 4.6543566775000000d0,  0.6517926931000000d0, 10.7842919661999996d0, &
 4.1428183209000000d0,  1.2941025051999999d0, 12.1320645383999999d0, &
 5.6514103362999997d0, 16.7154261276000007d0,  4.8185502772000000d0, &
 6.6667802855999998d0, 16.6020512973999992d0,  4.6371528610999997d0, &
 5.3750435125999996d0, 17.3069093386000006d0,  4.0600484612000001d0, &
14.5199039466999995d0,  5.3038662441000000d0,  5.1403959577000000d0, &
15.1966928092000000d0,  4.6514533551000001d0,  5.1421681589999997d0, &
13.9132645353999997d0,  5.0234530431000000d0,  4.3755413292999998d0, &
 9.8794820976000004d0, 14.3607597410000007d0,  2.8841033431000000d0, &
 9.3737300605999998d0, 14.3018556756000006d0,  2.0772622359000001d0, &
10.6563272419999997d0, 13.7595532904999995d0,  2.8279813952000001d0, &
-0.4372593627000000d0, 11.2305823956000008d0,  2.9947523695000000d0, &
 0.4627910712000000d0, 10.8985542023999997d0,  3.2668615464999999d0, &
-0.5230725830000000d0, 11.1340033876000000d0,  2.0273795408000002d0, &
 7.1802139131000002d0,  8.0037451145999992d0, 16.4869249639000017d0, &
 7.6530405592999999d0,  8.6161417561999993d0, 15.9636875423000006d0, &
 6.2832402177000004d0,  7.8448985134000004d0, 16.0443344524000011d0, &
 7.4219972636999998d0,  4.1557337233000000d0,  9.3058672785999992d0, &
 7.2494284088000001d0,  3.9983451232000000d0, 10.2654507378000002d0, &
 6.8239975206999999d0,  3.4268786136000000d0,  8.9671442889000001d0, &
 1.8216440043000000d0,  3.1769102062000001d0, 12.2703551700000002d0, &
 2.3285271621999999d0,  3.2591064873000000d0, 11.4762042106000006d0, &
 1.3120191926000000d0,  4.0540215967000002d0, 12.2033059521999991d0, &
 4.6734121310000001d0,  7.5046597173000000d0, 15.2776030136000003d0, &
 4.5507380918000004d0,  7.1247468442999997d0, 14.3800557395999995d0, &
 3.9877337318000001d0,  7.0501139324000004d0, 15.8811692292999993d0, &
 2.8630821332999998d0,  4.7610568498000001d0,  3.7590841388000000d0, &
 3.4954128704000000d0,  4.0391087384000004d0,  4.1154646239000003d0, &
 2.5306862233000000d0,  4.6560127086999996d0,  2.8221902275000001d0, &
 3.4366773731000002d0,  8.4375833306000008d0, 10.8204037391999996d0, &
 3.4842344268000001d0,  7.9566564709999996d0,  9.9632780961999998d0, &
 2.5882398802000002d0,  8.8433370775999993d0, 10.8855056611999998d0, &
17.9757907967000001d0, 13.2562453027000000d0,  9.1447189040999994d0, &
18.1207454574000018d0, 13.4442064276999993d0, 10.1340119095999999d0, &
17.0798775505000009d0, 12.9048403699000005d0,  9.1375230653999999d0, &
 5.9399612309999998d0, 15.8881457804000004d0,  2.0547181337999998d0, &
 6.5213741834999999d0, 16.1129104783999999d0,  2.7819690506999999d0, &
 5.6384529784000001d0, 16.6212162083000017d0,  1.5240943022000000d0, &
12.5060853639000005d0,  1.2104086916000001d0,  4.2278494901999997d0, &
13.0974827990999998d0,  0.3465875062000000d0,  4.1024069457000003d0, &
12.1559836629000007d0,  1.3176954955000000d0,  5.1128490788000001d0, &
16.6770295500000003d0,  8.5613409411999992d0,  7.8259293950000002d0, &
17.6578328083999985d0,  8.5272158088999994d0,  7.6239638887999996d0, &
16.1907672528999989d0,  8.1689918911999992d0,  7.0030381550999996d0, &
12.7013469367000003d0,  9.0676894924999996d0,  9.1934617141999997d0, &
12.5254850392999995d0,  8.4626923137999999d0,  8.4171429718000006d0, &
11.8805784599000006d0,  9.5389883983000008d0,  9.3683062368000005d0, &
15.1224867247999999d0, 11.2331968773999993d0,  3.5837478974999999d0, &
15.9965555005999995d0, 10.9280597516999993d0,  3.3055712056000002d0, &
14.6283360430999991d0, 11.5219733995000002d0,  2.7628431118000001d0, &
 5.6402074652999996d0, 15.5490453775000006d0,  7.5459450727000004d0, &
 6.5251641658999997d0, 15.1222750824999999d0,  7.4382200666999996d0, &
 5.8336559999000004d0, 16.3867297626000017d0,  7.0095696048000002d0, &
15.7317007135000004d0,  0.9418940775000000d0, 11.5840034311999993d0, &
15.9727352045999993d0,  0.5391590772000000d0, 10.7305100178000004d0, &
15.6430399251000001d0,  0.1492220037000000d0, 12.2221091132000002d0, &
 6.6520854095999997d0, 12.6405151547999992d0, 16.7219241994000001d0, &
 6.5345064493000002d0, 13.5518799681999997d0, 16.3800819562999997d0, &
 5.8709393577000002d0, 12.2021343674999994d0, 16.3000257799000003d0, &
 6.2640518116999999d0,  1.6431062767000000d0,  8.8789131251000004d0, &
 6.4855889177000003d0,  0.7214174207000000d0,  9.0710655138000007d0, &
 5.3362838797999999d0,  1.5423026271000000d0,  8.5814549793000001d0, &
 8.0836420463999996d0,  9.8477232569000002d0, 14.6368755773999997d0, &
 8.6307404141999999d0, 10.6268621564999997d0, 14.4635032276000004d0, &
 7.7554073786000002d0,  9.5314753757999995d0, 13.7470770226999992d0, &
 4.3390282750000004d0, 13.0326743792999995d0, 13.4094014294000008d0, &
 4.6641172107999997d0, 12.1954621336999995d0, 13.0342340060000002d0, &
 3.4004186624999999d0, 12.7978990930999998d0, 13.5119659058000003d0, &
 1.8756398325999999d0, 17.1870041775000004d0, 18.9549080023999998d0, &
 1.7670992111999999d0, 17.3852069257999986d0, 19.8784119478000001d0, &
 1.5998145149000000d0, 18.0607941821000004d0, 18.6269082855999990d0, &
 6.5014365450999998d0,  3.2115973561000000d0, 11.8238135669000002d0, &
 6.6373502563000004d0,  3.0090661028999999d0, 12.7813516475999993d0, &
 5.7062499368999999d0,  2.6263520925999999d0, 11.6725467440999999d0, &
13.1877537473000004d0,  2.3744706996999998d0, 16.1664449824000016d0, &
14.1727452858999996d0,  2.2844039350999998d0, 16.3536082064999988d0, &
13.0063994054999998d0,  3.0011012660000000d0, 16.9501516266000003d0, &
12.3982453065999998d0,  7.6870722706999999d0,  6.8652571433000000d0, &
12.6649701912000001d0,  7.4489038080999999d0,  5.9189963348000001d0, &
11.6882364322000001d0,  8.3644035715000005d0,  6.7933953471999997d0, &
 3.8815017831000000d0,  7.1031837556999999d0,  8.3417250253000006d0, &
 4.3925549472999998d0,  7.5738721618999998d0,  7.6244009721000001d0, &
 3.0106453088000000d0,  6.8027320365000001d0,  7.9233719409000001d0, &
16.4970403477000005d0,  3.9782034877000001d0,  6.4643586761999998d0, &
16.7253153246000004d0,  3.5012754558000001d0,  7.3189173869999999d0, &
16.3382880999000015d0,  3.1595710132999999d0,  5.9102483281999998d0, &
 9.6529258055000007d0,  0.6971842824000000d0, 13.9720759257000005d0, &
 9.3663091537999996d0,  0.5345284925000000d0, 13.0517399021999996d0, &
10.5173539475000002d0,  1.1849758118000000d0, 13.8639733199999995d0, &
12.4289824836000005d0,  4.0116414816999999d0, 12.7149783799999998d0, &
12.6520281237999992d0,  3.8911308558000002d0, 11.7713182546000006d0, &
12.2725029199000009d0,  5.0012246329999996d0, 12.8086928512000000d0, &
15.1912721554000001d0,  7.4862837566999998d0,  0.6049572744000000d0, &
16.0608915944000010d0,  7.1380763942999996d0,  0.3405168214000000d0, &
15.1027758327000008d0,  7.6194110617000002d0,  1.5802022649000000d0, &
 8.6632372992000004d0,  8.3846921446000007d0,  5.0595064512999999d0, &
 9.5606536720000008d0,  8.7991030878000007d0,  5.0656696246999999d0, &
 8.3179783845999999d0,  8.5848185070999996d0,  4.1426163750000002d0, &
13.3847175954999997d0, 13.6375317063000008d0,  6.2922108682999998d0, &
13.1996857121000009d0, 13.9978586214000007d0,  7.2020115797999997d0, &
12.6118356632000008d0, 13.8593697732999992d0,  5.6305138743000001d0, &
 4.6779302748999996d0, 16.8853439527000013d0, 12.4997759988000006d0, &
 5.0165840845999998d0, 16.4350507798000010d0, 11.6853094283000001d0, &
 3.7133641775999999d0, 16.9161022008000010d0, 12.4263467443000000d0, &
12.5140796629000004d0,  9.1014750648000007d0, 16.6059011364000000d0, &
13.2262612740000005d0,  9.3794889692000005d0, 17.2184965540000015d0, &
11.8956358315999999d0,  8.7022812972000008d0, 17.2054396216000001d0, &
 3.0117693440000002d0, 16.1825180507999988d0,  5.2629995116000003d0, &
 3.9762487331999998d0, 16.2251625787000009d0,  5.0822539911000000d0, &
 2.6659280867000001d0, 16.1166944938000007d0,  4.3662417473000001d0, &
16.6560879624999991d0,  0.8121554737000000d0,  2.3842442858999999d0, &
16.9394011294000002d0,  1.2049455228999999d0,  1.5829623790000000d0, &
16.3621486730999983d0, -0.0764094021000000d0,  2.0773073613999999d0, &
 5.8173817315000003d0,  4.8633306211000003d0,  1.9468853487000000d0, &
 6.7475601481999998d0,  5.0286984161000001d0,  1.6301584287999999d0, &
 5.3474496435000001d0,  5.4467766450999999d0,  1.3541757312000000d0, &
16.7727614293000009d0,  7.7307602791000001d0, 10.1694551913000009d0, &
16.5639829051999996d0,  8.1166739109999995d0,  9.3133538224999999d0, &
16.4778032733000011d0,  8.3374787531999992d0, 10.8791972285000007d0, &
 0.2571215447000000d0, 13.8311193468999996d0, 11.7758494512999992d0, &
 1.2467488891000000d0, 13.7976899304000007d0, 11.5874771622000008d0, &
 0.0892177713000000d0, 14.6975290949000001d0, 12.3021281823000006d0, &
 1.7639214065000000d0,  5.9784892692999998d0,  7.2570887417999996d0, &
 1.4166542207999999d0,  5.5295483695999996d0,  6.4857546887000002d0, &
 1.1902280840999999d0,  5.6104343329999997d0,  7.9130035187000001d0, &
17.9946836493000006d0,  5.6652211628000000d0,  8.9964104119999995d0, &
17.4744961146999991d0,  5.1000834110000000d0,  8.3611683344000003d0, &
17.3796316892000000d0,  6.2309544965999999d0,  9.4251800275999997d0, &
12.7832459862000007d0, 16.1135709515999999d0,  0.8935184248000000d0, &
13.3779012212000001d0, 16.1371126627999999d0,  0.0622054990000000d0, &
13.2294485886000004d0, 15.5425400334999999d0,  1.5308202390000001d0, &
14.1423510254000000d0,  8.1761588273000001d0,  3.2007696605999998d0, &
13.6534830105000005d0,  9.0215255486999997d0,  2.9932033714999999d0, &
13.3712416673999996d0,  7.5593937764000003d0,  3.3974551107000002d0, &
 9.2062855602999996d0,  6.2301317953000002d0,  6.8552486062000000d0, &
 9.1043694366000008d0,  6.9043669649000003d0,  6.1381649115999997d0, &
 8.2229301006999993d0,  6.0427459273000004d0,  6.9092237365000004d0, &
 8.4550606970000004d0,  1.5025332646000000d0, 16.1250136216999991d0, &
 9.0422405763999993d0,  1.2649022056999999d0, 15.4159273960000007d0, &
 8.7954704852999992d0,  0.9836230427000000d0, 16.8959752963000014d0, &
15.4572858472999997d0,  8.0262315978000007d0,  5.5212874199000002d0, &
15.1556338272000009d0,  7.0891331299999996d0,  5.4957806982999999d0, &
15.0408312037999998d0,  8.4248461926000004d0,  4.7144306492999997d0, &
12.0152184013000003d0,  1.8309693190000000d0, 13.8779085213000002d0, &
12.4279522423000000d0,  1.7958889060000001d0, 14.7644063882999994d0, &
12.0786236418000001d0,  2.8534696564000002d0, 13.4985151509999994d0, &
 1.9632034374000000d0, 10.0547536341000008d0, -0.4236821819000000d0, &
 2.8655769020999999d0, 10.1086062542999997d0,  0.0005463541700000d0, &
 2.1275048162000001d0, 10.7746714710999996d0, -1.0965464314000000d0, &
10.8643951328000004d0,  9.5763668551999999d0,  5.8519338777999996d0, &
11.8209283319999994d0,  9.7945909664999995d0,  5.7201079400000001d0, &
10.1505082627000007d0, 10.3521597551000006d0,  5.5610304902000003d0, &
 5.3581522181999999d0, 18.7169426045999998d0, 16.0342755687000000d0, &
 6.0361594692000002d0, 18.5903974689000009d0, 15.3250614252999995d0, &
 4.4853876065999998d0, 18.3561390748000015d0, 15.7730731500000001d0, &
17.1253019582999997d0, 15.4414003666999999d0, 16.1642489370000000d0, &
17.6962014156999992d0, 16.0183940040000010d0, 15.6050086402999995d0, &
17.6346783932999998d0, 15.3588488622000003d0, 17.0157387409000016d0, &
15.9212009535999997d0, 13.3052851580000002d0, 14.7406108926999995d0, &
16.1898054458000011d0, 14.0570750222999994d0, 15.2122077758999996d0, &
14.9445259322999995d0, 13.2990002203000000d0, 14.5205474512000006d0, &
12.4855008645000005d0,  4.2225983367000000d0,  3.6962638514999999d0, &
12.7579497880999995d0,  3.8395231359999999d0,  2.8896261820000002d0, &
11.9873424045999997d0,  3.5978833665000001d0,  4.2005660919999999d0, &
12.5298668742999997d0, 10.8086798737999992d0, 14.2311132529000002d0, &
12.7218876158000000d0, 10.1694234914999999d0, 13.5281681971999994d0, &
12.4904117121000002d0, 10.2418144866999992d0, 15.0665922690999992d0, &
 6.2237767453000004d0,  2.1524690995000002d0, 14.4608035294999997d0, &
 6.9968938151000000d0,  1.9497882981000001d0, 14.9446786504000002d0, &
 5.6707641403000002d0,  1.3360826441000000d0, 14.3609398699999993d0, &
 8.2471818858999999d0, 17.0663986389000009d0, 15.5967029381000000d0, &
 9.2086195927999999d0, 17.0360362645000016d0, 15.6626652279999998d0, &
 8.0011541277999996d0, 17.6504820140000014d0, 14.8623208871999992d0, &
 1.8296830557999999d0, -0.3224306337000000d0,  2.8762585923000001d0, &
 1.4025034613000000d0,  0.5777359704000000d0,  2.7551939669999999d0, &
 1.2374252527000000d0, -0.7327306814000000d0,  3.5131024385999998d0/)

atype0=(/ &
1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2,1,2,2/)

!--- local unit cell parameters
lata=18.646900d0
latb=18.646900d0
latc=18.646900d0
lalpha=90.0000d0
lbeta=90.0000d0
lgamma=90.0000d0

iigd = mx*my*mz*nH2O*myid ! for global ID
ntot=0
do ix=0,mx-1
do iy=0,my-1
do iz=0,mz-1
   do imos2=1,nH2O
      ntot=ntot+1
      rreal(ntot,1:3) = pos0(3*imos2-2:3*imos2)+(/ix,iy,iz/)  ! repeat unit cell
      rreal(ntot,1:3) = rreal(ntot,1:3)+vID(1:3)*(/mx,my,mz/) ! adding the box origin
      rreal(ntot,1:3) = rreal(ntot,1:3)*(/lata,latb,latc/) ! real coords
      atype(ntot) = dble(atype0(imos2)) + (iigd+ntot)*1d-13
   enddo 
enddo; enddo; enddo
NATOMS=ntot

!--- update to glocal cell parameters
lata=lata*mx*vprocs(1)
latb=latb*my*vprocs(2)
latc=latc*mz*vprocs(3)

call get_boxparameters(mat,lata,latb,latc,lalpha,lbeta,lgamma)
do i=1, 3
do j=1, 3
   HH(i,j,0)=mat(i,j)
enddo; enddo
call update_box_params(vprocs, vid, hh, lata, latb, latc, maxrc, &
                       cc, lcsize, hhi, mdbox, lbox, obox)

call system_clock(tj,tk)
it_timer(22)=it_timer(22)+(tj-ti)

return
end


!--------------------------------------------------------------------------
subroutine ReadBIN(atype, rreal, v, q, f, fileName)
!--------------------------------------------------------------------------
implicit none

character(*),intent(in) :: fileName
real(8),allocatable,dimension(:) :: atype,q
real(8),allocatable,dimension(:,:) :: rreal,v,f

integer :: i,i1

integer (kind=MPI_OFFSET_KIND) :: offset, offsettmp
integer (kind=MPI_OFFSET_KIND) :: fileSize
integer :: localDataSize, metaDataSize, scanbuf
integer :: fh ! file handler

integer :: nmeta
integer,allocatable :: idata(:)
real(8),allocatable :: dbuf(:)
real(8) :: ddata(6), d10(10)

real(8) :: rnorm(NBUFFER,3), mat(3,3)
integer :: j

integer :: ti,tj,tk
call system_clock(ti,tk)


! Meta Data: 
!  Total Number of MPI ranks and MPI ranks in xyz (4 integers)
!  Number of resident atoms per each MPI rank (nprocs integers) 
!  current step (1 integer) + lattice parameters (6 doubles)

nmeta=4+nprocs+1
allocate(idata(nmeta))
metaDataSize = 4*nmeta + 8*6

if(myid==0) write(6,'(2a)') 'INFO: Opening file in ReadBIN(): ', trim(fileName)
call MPI_File_Open(MPI_COMM_WORLD,trim(fileName),MPI_MODE_RDONLY,MPI_INFO_NULL,fh,ierr)

if(ierr > 0) then
   if(myid==0) write(6,'(2a)') 'MPI_File_Open Error in ReadBIN(): ', trim(fileName)
   call MPI_Finalize(ierr)
   stop
endif

! read metadata at the beginning of file
offsettmp=0
call MPI_File_Seek(fh,offsettmp,MPI_SEEK_SET,ierr)
call MPI_File_Read(fh,idata,nmeta,MPI_INTEGER,MPI_STATUS_IGNORE,ierr)

offsettmp=4*nmeta
call MPI_File_Seek(fh,offsettmp,MPI_SEEK_SET,ierr)
call MPI_File_Read(fh,ddata,6,MPI_DOUBLE_PRECISION,MPI_STATUS_IGNORE,ierr)

NATOMS = idata(4+myid+1)
current_step = idata(nmeta)
deallocate(idata)
lata=ddata(1); latb=ddata(2); latc=ddata(3)
lalpha=ddata(4); lbeta=ddata(5); lgamma=ddata(6)

! Get local datasize: 10 doubles for each atoms
localDataSize = 8*NATOMS*10

! offset will point the end of local write after the scan
call MPI_Scan(localDataSize,scanbuf,1,MPI_INTEGER,MPI_SUM,MPI_COMM_WORLD,ierr)

! Since offset is MPI_OFFSET_KIND and localDataSize is integer, use an integer as buffer
offset = scanbuf + metaDataSize

! nprocs-1 rank has the total data size
fileSize = offset
!call MPI_Bcast(fileSize,1,MPI_INTEGER,nprocs-1,MPI_COMM_WORLD,ierr)
!call MPI_File_set_size(fh, fileSize, ierr)

! set offset at the beginning of the local write
offset=offset-localDataSize
call MPI_File_Seek(fh,offset,MPI_SEEK_SET,ierr)

allocate(dbuf(10*NATOMS))
call MPI_File_Read(fh,dbuf,10*NATOMS,MPI_DOUBLE_PRECISION,MPI_STATUS_IGNORE,ierr)

if(.not.allocated(atype)) call allocator(atype,1,NBUFFER)
if(.not.allocated(q)) call allocator(q,1,NBUFFER)
if(.not.allocated(rreal)) call allocator(rreal,1,NBUFFER,1,3)
if(.not.allocated(v)) call allocator(v,1,NBUFFER,1,3)
if(.not.allocated(f)) call allocator(f,1,NBUFFER,1,3)
if(.not.allocated(qsfp)) call allocator(qsfp,1,NBUFFER)
if(.not.allocated(qsfv)) call allocator(qsfv,1,NBUFFER)
f(:,:)=0.0

do i=1, NATOMS
    i1=10*(i-1)
    rnorm(i,1:3)=dbuf(i1+1:i1+3)
    v(i,1:3)=dbuf(i1+4:i1+6)
    q(i)=dbuf(i1+7)
    atype(i)=dbuf(i1+8)
    qsfp(i)=dbuf(i1+9)
    qsfv(i)=dbuf(i1+10)
enddo
deallocate(dbuf)

call MPI_BARRIER(MPI_COMM_WORLD, ierr)
call MPI_File_Close(fh,ierr)

call get_boxparameters(mat,lata,latb,latc,lalpha,lbeta,lgamma)
do i=1, 3
do j=1, 3
   HH(i,j,0)=mat(i,j)
enddo; enddo

! Check: box params are updated first time here but cutoff distance is determined 
! based on ffield params. give a flag? 
call update_box_params(vprocs, vid, hh, lata, latb, latc, maxrc, &
                       cc, lcsize, hhi, mdbox, lbox, obox)

call xs2xu(hh,obox,NATOMS,rnorm,rreal)

call system_clock(tj,tk)
it_timer(22)=it_timer(22)+(tj-ti)

return
end

!--------------------------------------------------------------------------
subroutine WriteBIN(atype, rreal, v, q, fileNameBase)
!--------------------------------------------------------------------------
implicit none

real(8),allocatable,intent(in) :: atype(:), q(:)
real(8),allocatable,intent(in) :: rreal(:,:),v(:,:)
character(len=:),allocatable,intent(in) :: fileNameBase

integer :: i,j

integer (kind=MPI_OFFSET_KIND) :: offset, offsettmp
integer :: localDataSize, metaDataSize, scanbuf
integer :: fh ! file handler

integer :: nmeta
integer,allocatable :: ldata(:),gdata(:)
real(8) :: ddata(6)
real(8),allocatable :: dbuf(:)

real(8) :: rnorm(NBUFFER,3)

integer :: ti,tj,tk
call system_clock(ti,tk)

call xu2xs(hhi,obox,NATOMS,rreal,rnorm)

if(.not. isBinary) return

! Meta Data: 
!  Total Number of MPI ranks and MPI ranks in xyz (4 integers)
!  Number of resident atoms per each MPI rank (nprocs integers) 
!  current step (1 integer) + lattice parameters (6 doubles)
nmeta=4+nprocs+1
metaDataSize = 4*nmeta + 8*6

! Get local datasize: 10 doubles for each atoms
localDataSize = 8*NATOMS*10

call MPI_File_Open(MPI_COMM_WORLD,trim(fileNameBase)//".bin",MPI_MODE_WRONLY+MPI_MODE_CREATE,MPI_INFO_NULL,fh,ierr)

! offset will point the end of local write after the scan
call MPI_Scan(localDataSize,scanbuf,1,MPI_INTEGER,MPI_SUM,MPI_COMM_WORLD,ierr)

! Since offset is MPI_OFFSET_KIND and localDataSize is integer, use an integer as buffer
offset = scanbuf + metaDataSize

! save metadata at the beginning of file
allocate(ldata(nmeta),gdata(nmeta))
ldata(:)=0
ldata(4+myid+1)=NATOMS
call MPI_ALLREDUCE(MPI_IN_PLACE,ldata,nmeta,MPI_INTEGER,MPI_SUM,MPI_COMM_WORLD,ierr)
gdata = ldata
gdata(1)=nprocs
gdata(2:4)=vprocs
gdata(nmeta)=nstep+current_step

ddata(1)=lata; ddata(2)=latb; ddata(3)=latc
ddata(4)=lalpha; ddata(5)=lbeta; ddata(6)=lgamma

if(myid==0) then
   offsettmp=0
   call MPI_File_Seek(fh,offsettmp,MPI_SEEK_SET,ierr)
   call MPI_File_Write(fh,gdata,nmeta,MPI_INTEGER,MPI_STATUS_IGNORE,ierr)

   offsettmp=4*nmeta
   call MPI_File_Seek(fh,offsettmp,MPI_SEEK_SET,ierr)
   call MPI_File_Write(fh,ddata,6,MPI_DOUBLE_PRECISION,MPI_STATUS_IGNORE,ierr)
endif
deallocate(ldata,gdata)

! set offset at the beginning of the local write
offset=offset-localDataSize
call MPI_File_Seek(fh,offset,MPI_SEEK_SET,ierr)

allocate(dbuf(10*NATOMS))
do i=1, NATOMS
   j = (i - 1)*10
   dbuf(j+1:j+3)=rnorm(i,1:3)
   dbuf(j+4:j+6)=v(i,1:3)
   dbuf(j+7)=q(i)
   dbuf(j+8)=atype(i)
   dbuf(j+9)=qsfp(i)
   dbuf(j+10)=qsfv(i)
enddo
call MPI_File_Write(fh,dbuf,10*NATOMS,MPI_DOUBLE_PRECISION,MPI_STATUS_IGNORE,ierr)
deallocate(dbuf)

call MPI_BARRIER(MPI_COMM_WORLD, ierr)
call MPI_File_Close(fh,ierr)

call system_clock(tj,tk)
it_timer(23)=it_timer(23)+(tj-ti)

return
end

end module
